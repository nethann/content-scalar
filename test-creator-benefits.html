<!DOCTYPE html>
<html>
<head>
    <title>Test Creator Benefits</title>
</head>
<body>
    <h1>Test Creator Benefits</h1>
    <button onclick="testGetBenefits()">Test Get Benefits</button>
    <div id="result"></div>

    <script>
        const API_URL = 'http://localhost:3001/api';

        async function testGetBenefits() {
            const email = 'nethann772@gmail.com';
            const resultDiv = document.getElementById('result');
            
            try {
                console.log('Testing get benefits for:', email);
                
                const response = await fetch(`${API_URL}/creator-benefits/${encodeURIComponent(email)}`);
                const result = await response.json();
                
                console.log('API Response:', result);
                resultDiv.innerHTML = '<pre>' + JSON.stringify(result, null, 2) + '</pre>';
                
                if (result.success && result.benefit) {
                    console.log('‚úÖ Found benefits:', result.benefit);
                    
                    // Test the client service
                    const ClerkDatabaseService = {
                        async getCreatorBenefits(email) {
                            console.log('üîç Looking for creator benefits via server API for:', email);
                            
                            const response = await fetch(`${API_URL}/creator-benefits/${encodeURIComponent(email.toLowerCase())}`);
                            
                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                            }
                            
                            const result = await response.json();
                            
                            if (result.success) {
                                if (result.benefit) {
                                    console.log('‚úÖ Found benefits via server API:', result.benefit);
                                    return { success: true, benefits: result.benefit };
                                } else {
                                    console.log('‚ùå No benefits found via server API for:', email);
                                    return { success: true, benefits: null };
                                }
                            } else {
                                throw new Error('Server returned error');
                            }
                        }
                    };
                    
                    const serviceResult = await ClerkDatabaseService.getCreatorBenefits(email);
                    console.log('Service result:', serviceResult);
                    resultDiv.innerHTML += '<br><br><strong>Service Result:</strong><br><pre>' + JSON.stringify(serviceResult, null, 2) + '</pre>';
                    
                } else {
                    console.log('‚ùå No benefits found');
                }
                
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
            }
        }
    </script>
</body>
</html>